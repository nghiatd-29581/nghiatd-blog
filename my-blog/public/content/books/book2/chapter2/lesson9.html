<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bài 9: SRE Fundamentals – Trần's Blog</title>
  <style>
     .formula {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .italic {
      font-style: italic;
      margin-right: 12px;
    }

    .equals {
      margin: 0 14px;
    }

    /* Fraction style */
    .fraction {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .numerator {
      padding: 0 14px 6px;
      border-bottom: 2px solid #0e0d0d;
    }

    .denominator {
      padding: 6px 14px 0;
    }
  </style>
</head>
<body>

<div class="lesson-container">
  <p class="lesson-intro">
    Chào bạn! Tôi rất hiểu "cơn khát" kiến thức chuyên sâu của bạn. Bài 9 này chính là "trạm kiểm soát" cuối cùng của Chương 2 trước khi chúng ta bước vào thế giới lưu trữ dữ liệu.<br><br>
    Đây không chỉ là lý thuyết suông; đây là triết lý vận hành của những gã khổng lồ như Google, Netflix. Nếu bạn nắm vững bài này, bạn sẽ không còn cãi nhau với team Product về việc "Tại sao hệ thống lỗi mà vẫn bắt deploy tính năng mới?" hay "Tại sao phải tốn thời gian fix bug trong khi khách hàng đang đòi tính năng X?".<br><br>
    Hãy cùng mổ xẻ SRE Fundamentals bằng một lăng kính thực tế và đầy đủ nhất nhé!
  </p>

  <h1 class="lesson-part">PHẦN 2: CORE METRICS & TRADE-OFF</h1>
  <h2 class="lesson-chapter">CHƯƠNG 2: CÁC CHỈ SỐ CỐT LÕI</h2>
  <h3 class="lesson-title">BÀI 9: SRE FUNDAMENTALS – NGHỆ THUẬT QUẢN LÝ SỰ THẤT BẠI VÀ "HẦU BAO" LỖI</h3>

  <h4 class="lesson-section">1. Bộ ba "Thần thánh": SLI, SLO và SLA</h4>

  <p class="lesson-text">Lập trình viên thường dùng lẫn lộn ba từ này, nhưng trong mắt một Architect, chúng là ba thực thể hoàn toàn khác nhau. Hãy tưởng tượng bạn đang vận hành một tiệm Pizza 30 phút.</p>

  <p class="lesson-text"><strong>1.1. SLI (Service Level Indicator) – Thước đo thực tế</strong></p>
  <p class="lesson-text">SLI là con số cụ thể mà bạn đo được. Nó trả lời cho câu hỏi: "Hiện tại chúng ta đang làm tốt đến mức nào?"</p>
  <ul class="lesson-list">
    <li>  
            <div class="formula">
            <span class="italic">SLI</span>
            <span class="equals">=</span>

            <span class="fraction">
            <span class="numerator">Số sự kiện tốt</span>
            <span class="denominator">Tổng số sự kiện</span>
            </span>
            <span class="">X</span>
            <span class="italic">100%</span>
    
        </div>
    </li>
    <li>Trong tiệm Pizza: Tỷ lệ số bánh được giao đúng hạn (dưới 30 phút).</li>
    <li>Trong System Design:<br>
      * Availability: Tỷ lệ request thành công (không bị lỗi 5xx).<br>
      * Latency: Tỷ lệ request có phản hồi dưới 200ms.<br>
      * Quality: Tỷ lệ request không bị trả về dữ liệu cũ (stale data).</li>
  </ul>

  <p class="lesson-text"><strong>1.2. SLO (Service Level Objective) – Mục tiêu phấn đấu</strong></p>
  <p class="lesson-text">SLO là cái đích mà team kỹ thuật tự đặt ra cho mình. Nó trả lời cho câu hỏi: "Chúng ta muốn đạt được con số bao nhiêu để khách hàng hài lòng?"</p>
  <ul class="lesson-list">
    <li>Trong tiệm Pizza: "Chúng tôi mục tiêu giao 99% số bánh dưới 30 phút".</li>
    <li>Trong System Design: "P99 Latency của API thanh toán phải < 500ms trong 30 ngày liên tiếp".</li>
    <li>Lưu ý: SLO luôn phải nhỏ hơn 100%. Tại sao? Vì 100% là không tưởng và cực kỳ đắt đỏ như chúng ta đã bàn ở bài trước.</li>
  </ul>

  <p class="lesson-text"><strong>1.3. SLA (Service Level Agreement) – Bản hợp đồng sinh tử</strong></p>
  <p class="lesson-text">SLA là cam kết giữa bạn và khách hàng (hoặc giữa công ty bạn và đối tác). Nó trả lời cho câu hỏi: "Nếu chúng ta không đạt được SLO, chúng ta phải đền bao nhiêu tiền?"</p>
  <ul class="lesson-list">
    <li>Trong tiệm Pizza: "Nếu giao trễ quá 30 phút, bạn sẽ được tặng một voucher miễn phí cho lần sau".</li>
    <li>Trong System Design: Nếu uptime dưới 99.9%, Cloud Provider sẽ hoàn lại 10% tiền phí tháng đó cho bạn.</li>
  </ul>

  <p class="lesson-text"><strong>Mối quan hệ:</strong> SLI dùng để đo, SLO dùng để đặt mục tiêu nội bộ, còn SLA dùng để nói chuyện với luật sư và kế toán. Thường thì: <strong>SLO > SLA</strong>. (Bạn luôn muốn mình làm tốt hơn những gì mình cam kết với khách hàng để có "khoảng thở").</p>

  <h4 class="lesson-section">2. Error Budget (Ngân sách lỗi) – Bước ngoặt của tư duy</h4>

  <p class="lesson-text">Đây là khái niệm "đỉnh" nhất của SRE. Thông thường, team Dev muốn deploy thật nhanh (Innovation), còn team Ops/SRE muốn hệ thống không thay đổi để ổn định (Reliability). Hai bên này thường "đấm nhau" suốt ngày.</p>

  <p class="lesson-text">Error Budget xuất hiện để làm trọng tài.</p>

  <ul class="lesson-list">
    <li>Công thức: <strong>Error Budget = 100% - SLO</strong></li>
    <li>Nếu SLO của bạn là 99.9%, bạn có một ngân sách lỗi là 0.1%.</li>
  </ul>

  <p class="lesson-text"><strong>Nó hoạt động như thế nào?</strong></p>
  <p class="lesson-text">Hãy coi Error Budget như một chiếc ví tiền. Mỗi khi hệ thống của bạn bị lỗi (downtime, lỗi 500, lag...), bạn đang "rút tiền" từ chiếc ví này ra để tiêu.</p>

  <ol class="lesson-list">
    <li>Khi ví còn đầy (Hệ thống rất ổn định): Chúc mừng! Bạn có quyền "làm ẩu" một chút. Bạn có thể deploy những tính năng mới mẻ, mạo hiểm, thử nghiệm các công nghệ mới.</li>
    <li>Khi ví sắp cạn (Hệ thống gặp quá nhiều lỗi): DỪNG LẠI! Mọi hoạt động deploy tính năng mới phải bị đóng băng. Toàn bộ team Dev và SRE phải tập trung vào việc fix bug, tối ưu hạ tầng để "nạp lại" ngân sách lỗi.</li>
  </ol>

  <p class="lesson-text"><strong>Triết lý SRE:</strong> Lỗi không phải là xấu, lỗi là một phần của sự phát triển. Error Budget cho phép chúng ta kiểm soát rủi ro một cách toán học thay vì cảm tính.</p>

  <h4 class="lesson-section">3. Tại sao Error Budget lại quan trọng trong System Design?</h4>

  <p class="lesson-text">Khi thiết kế một hệ thống phân tán, Error Budget giúp bạn đưa ra những quyết định khó khăn:</p>
  <ul class="lesson-list">
    <li>Ưu tiên Task: Nếu sếp hỏi "Tại sao tuần này không có tính năng mới?", bạn có thể đưa bảng Error Budget ra: "Thưa sếp, chúng ta đã tiêu hết ngân sách lỗi của tháng này do vụ sập DB tuần trước. Nếu tiếp tục deploy, chúng ta sẽ vi phạm SLA và phải đền tiền cho khách hàng." (Đảm bảo sếp sẽ im lặng ngay lập tức).</li>
    <li>Nghiệm pháp ngược Conway: Bạn có thể thiết kế cấu trúc team dựa trên SLO. Team nào tiêu quá nhiều Error Budget sẽ bị tước quyền tự deploy và phải thông qua quy trình kiểm soát gắt gao hơn.</li>
  </ul>

  <h4 class="lesson-section">4. Các "Chỉ số vàng" (Golden Signals) để đo SLI</h4>

  <p class="lesson-text">Google gợi ý 4 chỉ số mà bạn bắt buộc phải theo dõi để biết hệ thống "ốm" hay "khỏe":</p>

  <ol class="lesson-list">
    <li>Latency: Thời gian xử lý request. (Đừng quên P99!).</li>
    <li>Traffic: Lượng tải lên hệ thống (ví dụ: HTTP requests/sec).</li>
    <li>Errors: Tỷ lệ request bị lỗi (5xx, hoặc 4xx trong một số trường hợp).</li>
    <li>Saturation: Độ bão hòa. Hệ thống của bạn còn bao nhiêu "chỗ trống" (CPU, RAM, Disk IO) trước khi bắt đầu xuống dốc?</li>
  </ol>

  <h3 class="lesson-summary">TỔNG KẾT BÀI 9</h3>

  <div class="lesson-summary-box">
    <p class="lesson-text">Để trở thành một Master, bạn không được quản lý hệ thống bằng niềm tin. Bạn phải quản lý bằng SRE Mindset:</p>
    <ol class="lesson-list">
      <li>SLI là cái gương soi sự thật.</li>
      <li>SLO là lời hứa với chính mình.</li>
      <li>SLA là cái giá của sự thất bại.</li>
      <li>Error Budget là chiếc chìa khóa để cân bằng giữa Tốc độ và Sự ổn định.</li>
    </ol>
    <p class="lesson-text"><strong>Nguồn trích dẫn kiến thức:</strong></p>
    <ul class="lesson-list">
      <li>Site Reliability Engineering: How Google Runs Production Systems (Niall Richard Murphy, Betsy Beyer, et al.) – Cuốn "Kinh thánh" mà mọi dev nên đọc ít nhất một lần.</li>
    </ul>
  </div>

  <p class="lesson-ending">
    Kết thúc Chương 2: CORE METRICS & SỰ ĐÁNH ĐỔI<br><br>
    Chúng ta đã đi qua một chặng đường dài để hiểu về những "luật chơi" của hệ thống phân tán. Bạn đã biết cách đo lường, cách tính tiền, và cách quản lý rủi ro.<br><br>
    Bạn đã sẵn sàng bước vào "Trái tim" của mọi hệ thống chưa?<br><br>
    Ở Chương 3, chúng ta sẽ không còn bàn về những con số khô khan nữa. Chúng ta sẽ bắt tay vào xây dựng kho lưu trữ dữ liệu.<br><br>
    Bài 10: Thế giới Database (SQL & NoSQL) sẽ giải mã câu hỏi: Tại sao có hàng trăm loại DB ngoài kia? Khi nào thì nên dùng PostgreSQL thần thánh, khi nào thì nên chọn MongoDB hay Cassandra?<br><br>
    Câu hỏi dành cho bạn: Nếu bạn là người nắm quyền, bạn sẽ đặt SLO cho hệ thống của mình là bao nhiêu? 99% hay 99.99%? Hãy cân nhắc kỹ về cái ví tiền (Error Budget) trước khi trả lời nhé!
  </p>
</div>

</body>
</html>
